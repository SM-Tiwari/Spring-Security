SELECT MSISDN, STARTPERIOD, ENDPERIOD, INVOICEDATE, INVOICEDUEDATE,
THISMONTHBILL, TOTALDUE, TOTAL_PAYMENTRECEIVED, OUTSTANDINGBILLING FROM RPT_INVOICE_SUMMARY
where msisdn='0923679668'
ORDER BY ENDPERIOD DESC;

REM INSERTING into RPT_INVOICE_SUMMARY
SET DEFINE OFF;
Insert into RPT_INVOICE_SUMMARY (ID, MSISDN,STARTPERIOD,ENDPERIOD,INVOICEDATE,INVOICEDUEDATE,THISMONTHBILL,TOTALDUE,TOTAL_PAYMENTRECEIVED)
values (RPT_INVOICE_SUMMARY_SEQ.nextval, '0923679668',to_timestamp('16-09-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-10-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-10-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('20-10-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
'55000','55000','0');


Insert into RPT_INVOICE_SUMMARY (ID, MSISDN,STARTPERIOD,ENDPERIOD,INVOICEDATE,INVOICEDUEDATE,THISMONTHBILL,TOTALDUE,TOTAL_PAYMENTRECEIVED)
values (RPT_INVOICE_SUMMARY_SEQ.nextval, '0923679668',to_timestamp('16-10-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-11-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-11-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('20-11-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
'55000','55000','0');


Insert into RPT_INVOICE_SUMMARY (ID, MSISDN,STARTPERIOD,ENDPERIOD,INVOICEDATE,INVOICEDUEDATE,THISMONTHBILL,TOTALDUE,TOTAL_PAYMENTRECEIVED)
values (RPT_INVOICE_SUMMARY_SEQ.nextval, '0923679668',to_timestamp('16-11-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-12-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-12-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('20-12-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
'55000','55000','40000');


Insert into RPT_INVOICE_SUMMARY (ID, MSISDN,STARTPERIOD,ENDPERIOD,INVOICEDATE,INVOICEDUEDATE,THISMONTHBILL,TOTALDUE,TOTAL_PAYMENTRECEIVED)
values (RPT_INVOICE_SUMMARY_SEQ.nextval, '0923679668',to_timestamp('16-12-2017 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-01-2018 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('16-01-2018 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
to_timestamp('20-01-2018 00.00.00,000000000','DD-MM-RRRR HH24.MI.SSXFF'),
'150000','150000','0');

update rpt_invoice_summary set total_outstandingbilling = totaldue-paymentreceived
where msisdn='0923679668';
